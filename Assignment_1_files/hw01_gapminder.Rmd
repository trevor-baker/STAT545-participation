---
title: 'Assignment 1: gapminder exploration'
author: "Trevor Baker, 98610074"
date: "11/09/2019"
output: github_document
---

This document explores the _gapminder_ dataset of historical demographic data spanning from 1952 to 2007 in five-year intervals.

```{r load_data, echo=FALSE, message=FALSE, warning=FALSE}

library(gapminder)
data("gapminder")

#shorten name
gm <- gapminder

#subset to get first and last years
gm2 <- gm[which(gm$year==1952 | gm$year==2007),]


```

The dataset includes the following fields:

```{r, echo=FALSE}

names(gm)

```


While Europe is the richest continent on average, Kuwait, which is included in the Asian continent, is the richest country overall. In the graph below, all countries with average income values greater than $40000 have been labelled. These include Kuwait, Norway, Singapore, and the United States.

```{r}

{ 
  par(mar=c(5,6,1,1))
  boxplot(gm$gdpPercap~gm$continent,
        xlab="",
        ylab = "",
        yaxt="n",
        las=3 )
  
  #y tick mark valules
  ytick <- seq(0,120000,20000)
   
  #make y axis
  axis(2, 
       at=seq(0,12e4,2e4), 
       labels=format(ytick, scientific = FALSE), 
       las=1)
  mtext("GDP per capita ($)", 
        side=2, 
        line=4)
  
  #text for points with high income
  thresh <- 40000
  text( x=as.factor(gm$continent[gm$gdpPercap>thresh]),
        y=gm$gdpPercap[gm$gdpPercap>thresh],
        labels = gm$country[gm$gdpPercap>thresh],
        cex=0.5,
        pos=4,
        offset=0.5)
  
}

```

Some countries have gotten more wealthy over time:

```{r}

plot(x=gm$year[gm$country=="China"],
     y=gm$gdpPercap[gm$country=="China"],
     main="China",
     xlab="Year",
     ylab="GDP per capita ($)")

```


Some countries have gotten less wealthy over time:

```{r}
options(scipen = 8)
plot(x=gm$year[gm$country=="Kuwait"],
     y=gm$gdpPercap[gm$country=="Kuwait"],
     main="Kuwait",
     xlab="Year",
     ylab="GDP per capita ($)")

```


There seems to be an asymptotic relationship between life expectancy and GDP. Mean life expectancy doesn't increase much beyond 80 years, no matter how rich the country.
```{r}

leg.labels <- levels(as.factor(gm$continent))

{ plot(gm$gdpPercap,
     gm$lifeExp, 
     xlim=c(0,50000),
     ylab="Life expectancy (years)",
     xlab="GDP per capita",
     col=as.factor(gm$continent))
legend("bottomright", pch=21, pt.bg=1:length(leg.labels),
       legend=leg.labels ) }

```

