---
title: "Assignment 2"
author: "Trevor Baker"
date: "19/09/2019"
output: 
  html_document:
    keep_md: true
---





## EXERCISE 1
#### Basic 'dplyr'

__1.1__

```r
knitr::kable(
  gapminder %>%
    filter(between(year,1970,1980) & (country=="China" | country=="Canada" | country=="United States"))
)
```



country         continent    year    lifeExp         pop    gdpPercap
--------------  ----------  -----  ---------  ----------  -----------
Canada          Americas     1972   72.88000    22284500   18970.5709
Canada          Americas     1977   74.21000    23796400   22090.8831
China           Asia         1972   63.11888   862030000     676.9001
China           Asia         1977   63.96736   943455000     741.2375
United States   Americas     1972   71.34000   209896000   21806.0359
United States   Americas     1977   73.38000   220239000   24072.6321


__1.2__

```r
knitr::kable(
  gapminder %>%
    filter(between(year,1970,1980) & (country=="China" | country=="Canada" | country=="United States")) %>%
    select(country, gdpPercap)
)
```



country           gdpPercap
--------------  -----------
Canada           18970.5709
Canada           22090.8831
China              676.9001
China              741.2375
United States    21806.0359
United States    24072.6321


__1.3__

```r
DT::datatable(
  gapminder %>%
    group_by(country) %>%
    mutate(lifeExp.incr=lifeExp-lag(lifeExp) ) %>%
    filter(lifeExp.incr<0)
)
```

<!--html_preserve--><div id="htmlwidget-02a6db1199db734dd3f1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-02a6db1199db734dd3f1">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102"],["Albania","Angola","Benin","Botswana","Botswana","Botswana","Bulgaria","Bulgaria","Bulgaria","Burundi","Cambodia","Cambodia","Cameroon","Cameroon","Cameroon","Central African Republic","Central African Republic","Central African Republic","Chad","Chad","China","Congo, Dem. Rep.","Congo, Dem. Rep.","Congo, Dem. Rep.","Congo, Dem. Rep.","Congo, Rep.","Congo, Rep.","Cote d'Ivoire","Cote d'Ivoire","Cote d'Ivoire","Croatia","Czech Republic","Denmark","El Salvador","El Salvador","Eritrea","Gabon","Gabon","Gabon","Ghana","Hungary","Hungary","Iraq","Iraq","Iraq","Jamaica","Jamaica","Kenya","Kenya","Kenya","Korea, Dem. Rep.","Korea, Dem. Rep.","Korea, Dem. Rep.","Lesotho","Lesotho","Lesotho","Liberia","Malawi","Malawi","Montenegro","Mozambique","Mozambique","Myanmar","Namibia","Namibia","Netherlands","Nigeria","Nigeria","Norway","Poland","Poland","Puerto Rico","Romania","Romania","Rwanda","Rwanda","Serbia","Sierra Leone","Slovak Republic","Somalia","South Africa","South Africa","South Africa","Swaziland","Swaziland","Swaziland","Tanzania","Tanzania","Togo","Trinidad and Tobago","Trinidad and Tobago","Uganda","Uganda","Uganda","Uganda","Zambia","Zambia","Zambia","Zambia","Zimbabwe","Zimbabwe","Zimbabwe"],["Europe","Africa","Africa","Africa","Africa","Africa","Europe","Europe","Europe","Africa","Asia","Asia","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Asia","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Europe","Europe","Europe","Americas","Americas","Africa","Africa","Africa","Africa","Africa","Europe","Europe","Asia","Asia","Asia","Americas","Americas","Africa","Africa","Africa","Asia","Asia","Asia","Africa","Africa","Africa","Africa","Africa","Africa","Europe","Africa","Africa","Asia","Africa","Africa","Europe","Africa","Africa","Europe","Europe","Europe","Americas","Europe","Europe","Africa","Africa","Europe","Africa","Europe","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Americas","Americas","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa"],[1992,1987,2002,1992,1997,2002,1977,1992,1997,1992,1972,1977,1992,1997,2002,1992,1997,2002,1997,2002,1962,1982,1987,1992,1997,1992,1997,1992,1997,2002,1982,1972,1982,1977,1982,1982,1997,2002,2007,2002,1982,1992,1992,1997,2002,1992,2002,1992,1997,2002,1992,1997,2002,1997,2002,2007,1992,1997,2002,2002,2002,2007,2002,1997,2002,1972,1997,2002,1987,1977,1987,1992,1987,1992,1987,1992,1982,1992,1972,1992,1997,2002,2007,1997,2002,2007,1992,1997,2002,1997,2002,1977,1982,1992,1997,1987,1992,1997,2002,1992,1997,2002],[71.581,39.906,54.406,62.745,52.556,46.634,70.81,71.19,70.32,44.736,40.317,31.22,54.314,52.199,49.856,49.396,46.066,43.308,51.573,50.525,44.50136,47.784,47.412,45.548,42.587,56.433,52.962,52.044,47.991,46.832,70.46,70.29,74.63,56.696,56.604,43.89,60.461,56.761,56.735,58.453,69.39,69.17,59.461,58.811,57.046,71.766,72.047,59.285,54.407,50.992,69.978,67.727,66.662,55.558,44.593,42.592,40.802,47.495,45.009,73.981,44.026,42.082,59.908,58.909,51.479,73.75,47.464,46.608,75.89,70.67,70.98,73.911,69.53,69.36,44.02,23.599,70.162,38.333,70.35,39.658,60.236,53.365,49.339,54.289,43.869,39.613,50.44,48.466,57.561,69.465,68.976,50.35,49.849,48.825,44.578,50.821,46.1,40.238,39.193,60.377,46.809,39.989],[3326498,7874230,7026113,1342614,1536536,1630347,8797022,8658506,8066057,5809236,7450606,6978607,12467171,14195809,15929988,3265124,3696513,4048013,7562011,8835739,665770000,30646495,35481645,41672143,47798986,2409073,2800947,12772596,14625967,16252726,4413368,9862158,5117810,4282586,4474873,2637297,1126189,1299304,1454867,20550751,10705535,10348684,17861905,20775703,24001816,2378618,2664659,25020539,28263827,31386842,20711375,21585105,22215365,1982823,2046772,2012649,1912974,10419991,11824495,720230,18473780,19951656,45598081,1774766,1972153,13329874,106207839,119901274,4186147,34621254,37740710,3585176,22686371,22797027,6349365,7290203,9032824,4260884,4593433,6099799,42835005,44433622,43997828,1054486,1130269,1133066,26605473,30686889,4977378,1138101,1101832,11457758,12939400,18252190,21210254,7272406,8381163,9417789,10595811,10704340,11404948,11926563],[2497.437901,2430.208311,1372.877931,7954.111645,8647.142313,11003.60508,7612.240438,6302.623438,5970.38876,631.6998778,421.6240257,524.9721832,1793.163278,1694.337469,1934.011449,747.9055252,740.5063317,738.6906068,1004.961353,1156.18186,487.6740183,673.7478181,672.774812,457.7191807,312.188423,4016.239529,3484.164376,1648.073791,1786.265407,1648.800823,13221.82184,13108.4536,21688.04048,5138.922374,4098.344175,524.8758493,14722.84188,12521.71392,13206.48452,1111.984578,12545.99066,10535.62855,3745.640687,3076.239795,4390.717312,7404.923685,6994.774861,1341.921721,1360.485021,1287.514732,3726.063507,1690.756814,1646.758151,1186.147994,1275.184575,1569.331442,636.6229191,692.2758103,665.4231186,6557.194282,633.6179466,823.6856205,611,3899.52426,4072.324751,18794.74567,1624.941275,1615.286395,31540.9748,9508.141454,9082.351172,14641.58711,9696.273295,6598.409903,847.991217,737.0685949,15181.0927,1068.696278,9674.167626,926.9602964,7479.188244,7710.946444,9269.657808,3876.76846,4128.116943,4513.480643,825.682454,789.1862231,886.2205765,8792.573126,11460.60023,843.7331372,682.2662268,644.1707969,816.559081,1213.315116,1210.884633,1071.353818,1071.613938,693.4207856,792.4499603,672.0386227],[-0.418999999999997,-0.0360000000000014,-0.371000000000002,-0.877000000000002,-10.189,-5.922,-0.0900000000000034,-0.150000000000006,-0.870000000000005,-3.475,-5.098,-9.097,-0.670999999999999,-2.115,-2.343,-1.089,-3.33,-2.758,-0.150999999999996,-1.048,-6.0476,-0.0200000000000031,-0.372,-1.864,-2.961,-1.037,-3.471,-2.611,-4.053,-1.159,-0.180000000000007,-0.0899999999999892,-0.0600000000000023,-1.511,-0.0919999999999987,-0.644999999999996,-0.905000000000001,-3.7,-0.0260000000000034,-0.102999999999994,-0.560000000000002,-0.409999999999997,-5.583,-0.649999999999999,-1.765,-0.00399999999999068,-0.215000000000003,-0.054000000000002,-4.878,-3.415,-0.669000000000011,-2.25099999999999,-1.065,-4.127,-10.965,-2.001,-5.225,-1.925,-2.486,-1.464,-2.318,-1.944,-0.420000000000002,-3.09,-7.43,-0.0699999999999932,-0.00800000000000267,-0.856000000000002,-0.0799999999999983,-0.179999999999993,-0.339999999999989,-0.718999999999994,-0.129999999999995,-0.170000000000002,-2.198,-20.421,-0.137999999999991,-1.673,-0.63000000000001,-4.843,-1.652,-6.871,-4.026,-4.185,-10.42,-4.256,-1.095,-1.974,-0.829000000000001,-0.396999999999991,-0.489000000000004,-0.665999999999997,-0.501000000000005,-2.684,-4.247,-1,-4.721,-5.862,-1.045,-1.974,-13.568,-6.82]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>country<\/th>\n      <th>continent<\/th>\n      <th>year<\/th>\n      <th>lifeExp<\/th>\n      <th>pop<\/th>\n      <th>gdpPercap<\/th>\n      <th>lifeExp.incr<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->

__1.4__

```r
DT::datatable(
  gapminder %>%
    group_by(country) %>%
    summarize(max.gdp=max(gdpPercap))
)
```

<!--html_preserve--><div id="htmlwidget-92800b38aec6a87df02c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-92800b38aec6a87df02c">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142"],["Afghanistan","Albania","Algeria","Angola","Argentina","Australia","Austria","Bahrain","Bangladesh","Belgium","Benin","Bolivia","Bosnia and Herzegovina","Botswana","Brazil","Bulgaria","Burkina Faso","Burundi","Cambodia","Cameroon","Canada","Central African Republic","Chad","Chile","China","Colombia","Comoros","Congo, Dem. Rep.","Congo, Rep.","Costa Rica","Cote d'Ivoire","Croatia","Cuba","Czech Republic","Denmark","Djibouti","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Ethiopia","Finland","France","Gabon","Gambia","Germany","Ghana","Greece","Guatemala","Guinea","Guinea-Bissau","Haiti","Honduras","Hong Kong, China","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kenya","Korea, Dem. Rep.","Korea, Rep.","Kuwait","Lebanon","Lesotho","Liberia","Libya","Madagascar","Malawi","Malaysia","Mali","Mauritania","Mauritius","Mexico","Mongolia","Montenegro","Morocco","Mozambique","Myanmar","Namibia","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","Norway","Oman","Pakistan","Panama","Paraguay","Peru","Philippines","Poland","Portugal","Puerto Rico","Reunion","Romania","Rwanda","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Sierra Leone","Singapore","Slovak Republic","Slovenia","Somalia","South Africa","Spain","Sri Lanka","Sudan","Swaziland","Sweden","Switzerland","Syria","Taiwan","Tanzania","Thailand","Togo","Trinidad and Tobago","Tunisia","Turkey","Uganda","United Kingdom","United States","Uruguay","Venezuela","Vietnam","West Bank and Gaza","Yemen, Rep.","Zambia","Zimbabwe"],[978.0114388,5937.029526,6223.367465,5522.776375,12779.37964,34435.36744,36126.4927,29796.04834,1391.253792,33692.60508,1441.284873,3822.137084,7446.298803,12569.85177,9065.800825,10680.79282,1217.032994,631.6998778,1713.778686,2602.664206,36319.23501,1193.068753,1704.063724,13171.63885,4959.114854,7006.580419,1937.577675,905.8602303,4879.507522,9645.06142,2602.710169,14619.22272,8948.102923,22833.30851,35278.41874,3694.212352,6025.374752,7429.455877,5581.180998,5728.353514,12154.08975,913.47079,690.8055759,33207.0844,30470.0167,21745.57328,884.7552507,32170.37442,1327.60891,27538.41188,5186.050003,945.5835837,838.1239671,2011.159549,3548.330846,39724.97867,18008.94444,36180.78919,2452.210407,3540.651564,11888.59508,14688.23507,40675.99635,25523.2771,28569.7197,7433.889293,31656.06806,4519.461171,1463.249282,4106.525293,23348.13973,113523.1329,10461.05868,1569.331442,803.0054535,21951.21176,1748.562982,759.3499101,12451.6558,1042.581557,1803.151496,10956.99112,11977.57496,3095.772271,11732.51017,3820.17523,823.6856205,944,4811.060429,1091.359778,36797.93332,25185.00911,5486.371089,1054.384891,2013.977305,49357.19017,22316.19287,2605.94758,9809.185636,4258.503604,7408.905561,3190.481016,15389.92468,20509.64777,19328.70901,7670.122558,10808.47561,881.5706467,1890.218117,34167.7626,1712.472136,15870.87851,1465.010784,47143.17964,18678.31435,25768.25759,1450.992513,9269.657808,28821.0637,3970.095407,2602.394995,4513.480643,33859.74835,37506.41907,4184.548089,28718.27684,1107.482182,7458.396327,1649.660188,18008.50924,7092.923025,8458.276384,1056.380121,33203.26128,42951.65309,10611.46299,13143.95095,2441.576404,7110.667619,2280.769906,1777.077318,799.3621758]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>country<\/th>\n      <th>max.gdp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->


__1.5__

```r
gapminder %>%
  filter(country=="Canada") %>%
  ggplot(aes(x=gdpPercap,y=lifeExp)) + 
            geom_point() +
            scale_x_log10("GDP per capita", labels = scales::dollar_format()) +
            ylab("Life expectancy") +
            ggtitle("Canada's life expectancy vs per capita GDP") +
            theme_bw()
```

![](hw02_files/figure-html/unnamed-chunk-1-1.png)<!-- -->

---

## EXERCISE 2
#### Explore individal variables with 'dplyr'

I have chosen life expectancy and continent to summarize here.

There are 5 continents in the dataset:

```r
#display all continents - kind of useles
knitr::kable(
  gapminder %>%
    select(continent) %>%
    unique()
)
```



|continent |
|:---------|
|Asia      |
|Europe    |
|Africa    |
|Americas  |
|Oceania   |


Here are some summary stats on global life expectancies:

```r
#display range of lifeExp data by continent
knitr::kable(
  gapminder %>%
    select(lifeExp) %>%
    summarize(min.lifeExp=min(lifeExp)%>% round(digits=1),
              median.lifeExp=median(lifeExp)%>% round(digits=1),
              mean.lifeExp=mean(lifeExp)%>% round(digits=1),
              max.lifeExp=max(lifeExp) %>% round(digits=1)) 
)
```



 min.lifeExp   median.lifeExp   mean.lifeExp   max.lifeExp
------------  ---------------  -------------  ------------
        23.6             60.7           59.5          82.6

It is more informative to see these summary statistics divided up by continent:

```r
#display range of lifeExp data by continent
knitr::kable(
  gapminder %>%
    select(continent, lifeExp) %>%
    group_by(continent) %>%
    summarize(min.lifeExp=min(lifeExp)%>% round(digits=1),
              median.lifeExp=median(lifeExp)%>% round(digits=1),
              mean.lifeExp=mean(lifeExp)%>% round(digits=1),
              max.lifeExp=max(lifeExp) %>% round(digits=1)) 
)
```



continent    min.lifeExp   median.lifeExp   mean.lifeExp   max.lifeExp
----------  ------------  ---------------  -------------  ------------
Africa              23.6             47.8           48.9          76.4
Americas            37.6             67.0           64.7          80.7
Asia                28.8             61.8           60.1          82.6
Europe              43.6             72.2           71.9          81.8
Oceania             69.1             73.7           74.3          81.2


It's probably even more informative to see them graphed:

```r
#display range of both variables via boxplot
gapminder %>%
  select(continent, lifeExp) %>%
  group_by(continent) %>%
  ggplot(aes(x=continent, y=lifeExp)) +
    geom_boxplot(notch=T) +
    ylab("Life Expectancy") +
    xlab("Continent") +
    theme_bw()
```

![](hw02_files/figure-html/cont_le_boxplot-1.png)<!-- -->

---

## EXERCISE 3
#### Explore various plot types

__Plot 1__


```r
gapminder %>%
  ggplot(aes(x=pop, y=lifeExp, size=gdpPercap, fill=continent)) +
    geom_point(pch=21,colour="black") +
    scale_x_log10("Population", labels=scales::comma) +
    ylab("Life expectancy") +
    theme_bw() +
    scale_size_continuous(name="GDP per capita (US $, infl. adj.)", range=c(0.5,10)) +
    scale_fill_discrete(name="Continent") +
    guides(fill = guide_legend(override.aes = list(size=8))) +
    labs(title="Trends in GDP, life expectancy and population by country, 1952-2007")
```

![](hw02_files/figure-html/ex3_plot1-1.png)<!-- -->

__Plot 2__

```r
gapminder %>%
  mutate(gdp=gdpPercap*pop) %>%
  mutate(continent=factor(continent, #put small ones on top
                          levels=c("Oceania","Africa","Europe","Americas","Asia"))) %>%
  group_by(continent, year) %>%
  summarize(gdp.cont=sum(gdp)/1e12) %>%
  ggplot(aes(x=year, y=gdp.cont, fill=continent)) +
    geom_col() +
    scale_fill_brewer(palette="YlGn", 
                      name="Continent") +
    scale_y_continuous(name="GDP, trillions US $") +
    scale_x_continuous(name="Year") +
    labs(title="Growth in global GDP from 1952 to 2007")
```

![](hw02_files/figure-html/ex3_plot2-1.png)<!-- -->


